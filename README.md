# btcUah

Для построение Web Api я использовал библиотеку express, которая упростила создание endpoint-ов.
Серверную часть в моем проекте выполняет файл app.js, в котором как раз и есть 3 endpointa.

Сервер:

 Авторизация:

 Для авторизации я использовал JWT tokens. Endpoint - '/user/login'. Логика, такая если пользователь авторизировался, то ему возвращаеться
 определенный токен, который сохраняеться в localStorage. Этот токен будет отправляться в заголовке при любом запросе на сервер.
 При обработке запроса, сервер будет проверять правильный ли этот токен. Если он правильный, то возвращать данные 
 пользователю, если нет, то статус 401. Так же для того, чтобы пользователь не авторизовывался большое количество раз, при
 наличии токена в localStorage клиент будет отправялть запрос, для того чтобы получить курс биткона. Сервер будет проверять
 правильность токена и так же в зависимости от правильности, отправлять данные, либо статус 401.
 Для безопасности я использовал библиотеку bcrypt, которая зашифровывает пароль пользователя. Так же использовал ее функционал для сравнения паролей, при авторизации.
 Если при авторизации пользователь вводить неправильные данные, то ему возвращаеться статус 401 либо 404 в случае, если почта была не зарегистрирована

 Регистрация:

  Endpoint - '/user/create'.
  При регистрации пользователю также отправляется токен, который сохраняется в localStorage

  Курс биткона
  Endpoint - '/btcRate'.
  Для того чтобы получить курс биткона, я использовал coinmarketcap API, на который делал requests, с ключами ('start':'1','limit': '1','convert_id':2824)
  Первые два ключа нужны для того чтобы определить, что это биткон(На сайте первый криптовалюта это биткоин), а convert_id - ключ для гривны.
  Потом я из объкта достаю значение data, так как это масcив мы обращаемся к первому елементу(нулевому по индексу) и из поля 2824, объекта quote достаем значение                   курса.
  И отправляем это значение в этот на запрос. Так же перед тем как сделать request для получения курса, я проверяю авторизириован ли этот пользователь, с помощью                   токена(jwt.verify), если токен неправильный, то возвращается статус 401, если все хорошо, то делается запрос и потом возвращается ответ с курсом.

  База данных:

  Реализовал с помощью обычных json файлов. Вся логика в файле database.js, файл db.json.

Клиент:

  Для клиентской части я реализовал SPA-single page application, с помощью роутера и темплейт процессора. Запросы на сервер я делал с помощью обычных fetch запросов.
  Если на клиенте есть токен, то он сразу будет отправлять запрос на курс биткоина. В зависимости от статуса ответа и хеша в ссылке, отрисовывается нужная страница,               где добавляються все нужные eventListener.
  Для всех input форм я использую HTML5 валидацию(pattern,require), кроме формы, где вводить количество биткоинов, таи проверка осуществленна на клиенте.

            
